@{
    ViewData["Title"] = "Customer Management";
}

<style>
    .profile-picture {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
    }

    /* Remove any existing color overrides */
    .table span,
    .table p {
        color: initial;
    }

    /* Increase specificity for table headers */
    #customersTable thead th,
    #customersTable th {
        white-space: nowrap;
        color: #676E8A !important;
        font-weight: 600;
    }

    .table td {
        vertical-align: middle;
    }

    table.dataTable th.dt-type-numeric,
    table.dataTable th.dt-type-date,
    table.dataTable td.dt-type-numeric,
    table.dataTable td.dt-type-date {
        text-align: center;
    }
</style>

<div class="container-fluid pb-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Customer Management</h1>
    </div>

    <div class="card shadow">
        <div class="card-body">
            <table id="customersTable" class="table table-striped table-hover">
                <thead class="table-light">
                    <tr>
                        <th>Picture</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Nickname</th>
                        <th>Created At</th>
                        <th>Updated At</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            const table = $('#customersTable').DataTable({
                ajax: {
                    url: '/POS/Customer/GetCustomers',
                    dataSrc: 'data'
                },
                columns: [
                    {
                        data: 'picture',
                        render: function (data, type, row) {
                            if (type === 'display') {
                                return data ? `<img src="${data}" class="profile-picture" alt="Profile Picture">` 
                                    : '<img src="/images/default-avatar.png" class="profile-picture" alt="Default Profile">';
                            }
                            return data;
                        },
                        orderable: false
                    },
                    { 
                        data: 'name',
                        render: function (data, type, row) {
                            return data || 'N/A';
                        }
                    },
                    { data: 'email' },
                    { 
                        data: 'nickname',
                        render: function (data, type, row) {
                            return data || 'N/A';
                        }
                    },
                    { data: 'createdAt' },
                    { data: 'updatedAt' }
                ],
                order: [[4, 'desc']],
                responsive: true,
                pageLength: 25,
                language: {
                    emptyTable: "No customers found",
                    zeroRecords: "No matching customers found"
                }
            });
        });
    </script>
}